---
import { type CollectionEntry, getCollection } from 'astro:content'
import BaseLayout from '../../layouts/BaseLayout.astro'
import PageLayout from '../../components/PageLayout.astro'

export async function getStaticPaths() {
	const reviews = await getCollection('reading-list')
	return reviews.map((review: CollectionEntry<'reading-list'>) => ({
		params: { slug: review.slug },
		props: review,
	}))
}
type Props = CollectionEntry<'reading-list'>

const review = Astro.props
const { Content } = await review.render()
---

<BaseLayout
	title={review.data.title}
	description={`Review of ${review.data.title} by ${review.data.author}`}
>
	<PageLayout title={review.data.title}>
		<div class="max-w-3xl">
			<div class="mb-12">
				<div class="flex flex-wrap gap-4 text-muted-foreground mb-8">
					<span
						class="bg-primary/10 text-primary px-3 py-1 rounded-full text-sm font-medium"
					>
						{review.data.genre}
					</span>
					<span
						class="px-3 py-1 border border-foreground/20 rounded-full text-sm"
					>
						{review.data.rating}
					</span>
					<span
						class="px-3 py-1 border border-foreground/20 rounded-full text-sm"
					>
						{review.data.format}
					</span>
				</div>
				<p class="text-xl mb-4">
					by <span class="font-semibold">{review.data.author}</span>
				</p>
				<a
					href={review.data.link_amazon}
					target="_blank"
					rel="noopener noreferrer"
					class="text-primary hover:underline font-medium inline-flex items-center gap-1"
				>
					View on Bookshop / Amazon &rarr;
				</a>
			</div>

			<hr class="border-foreground/10 mb-12" />

			<div
				class="prose prose-neutral prose-lg md:prose-xl dark:prose-invert prose-img:rounded-xl"
			>
				<Content />
			</div>
		</div>
	</PageLayout>
</BaseLayout>
